'use client'

import { useState } from 'react'
import { Input } from '@/components/ui/input'
import { Button } from '@/components/ui/button'
import { ref, set } from 'firebase/database'
import { db } from '@/lib/firebase'

export default function Prenotazione() {
  const [nome, setNome] = useState('')
  const [data, setData] = useState('')
  const [orario, setOrario] = useState('')

  function prenota() {
    if (!nome || !data || !orario) return
    const key = `${data}_${orario.replace(':', '-')}`
    set(ref(db, 'prenotazioni/' + key), nome)
      .then(() => {
        alert('Prenotazione effettuata!')
        setNome('')
        setData('')
        setOrario('')
      })
      .catch((error) => {
        alert('Errore: ' + error.message)
      })
  }

  return (
    <form
      onSubmit={(e) => {
        e.preventDefault()
        prenota()
      }}
      className="grid gap-4"
    >
      <Input
        placeholder="Nome"
        value={nome}
        onChange={(e) => setNome(e.target.value)}
        required
      />
      <Input
        type="date"
        value={data}
        onChange={(e) => setData(e.target.value)}
        required
      />
      <Input
        type="time"
        value={orario}
        onChange={(e) => setOrario(e.target.value)}
        required
      />
      
      {/* Bottone per Android o clic */}
      <Button type="submit" className="w-full">
        Conferma prenotazione
      </Button>
    </form>
  )
}
