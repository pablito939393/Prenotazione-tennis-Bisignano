function creaTabella(prenotazioni) {
  tableBody.innerHTML = "";
  orari.forEach(orario => {
    const row = document.createElement("tr");
    const oraCell = document.createElement("td");
    oraCell.textContent = orario;
    row.appendChild(oraCell);

    giorni.forEach(giorno => {
      const cell = document.createElement("td");
      const pren = prenotazioni?.[giorno]?.[orario] || "";

      if (pren) {
        cell.textContent = pren;
        cell.classList.add("prenotato");
      } else {
        const input = document.createElement("input");
        input.placeholder = "Nome";

        const confermaBtn = document.createElement("button"); // AGGIUNTA
        confermaBtn.textContent = "Conferma"; // AGGIUNTA
        confermaBtn.style.marginTop = "4px"; // AGGIUNTA
        confermaBtn.style.fontSize = "12px"; // AGGIUNTA

        async function prenota() {
          const nome = input.value.trim();
          if (!nome) return;

          const count = contaPrenotazioni(prenotazioni, giorno, nome);
          if (count >= 2) {
            alert("Massimo 2 ore al giorno per utente.");
            return;
          }

          const cellRef = ref(db, `prenotazioni/${settimanaKey}/${giorno}/${orario}`);
          await set(cellRef, nome);
        }

        input.addEventListener("keydown", e => {
          if (e.key === "Enter") prenota();
        });
        confermaBtn.addEventListener("click", prenota); // AGGIUNTA

        const contenitore = document.createElement("div"); // AGGIUNTA
        contenitore.appendChild(input); // AGGIUNTA
        contenitore.appendChild(confermaBtn); // AGGIUNTA
        cell.appendChild(contenitore); // AGGIUNTA
      }

      row.appendChild(cell);
    });

    tableBody.appendChild(row);
  });
}
